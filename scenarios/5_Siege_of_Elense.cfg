[scenario]
    id="5_Siege_of_Elense"
    map_file=Siege_of_Elense.map
    name="Siege of Elense"
    turns=15
    {DEFAULT_SCHEDULE}
    {DEFAULT_MUSIC_PLAYLIST}
    next_scenario = 6_Hopeless
    experience_modifier={ON_DIFFICULTY 80 80 100}

    [story]
        [part]
            story =_  "After the swamp, it was only a few days to the city."
        [/part]
        [part]
            story =_  "However, when they found it... Wesnoth had it besieged."
        [/part]
    [/story]

    [side]
        
        side=1
        controller=human
        canrecruit=yes
        recruit="Aragwaith Spearman, Aragwaith Swordsman, Aragwaith Archer, Aragwaith Adept, Aragwaith Scout"
        team_name="Aragwaith"
        user_team_name=_ "Aragwaith"
        {GOLD 90 80 70}
        type = "Aragwaith Flagbearer"
        name = _ "Rokuhira"
        id="Rokuhira"
        gender=male
        unrenamable=yes
        [modifications]
            {TRAIT_INTELLIGENT}
            {TRAIT_LOYAL}
        [/modifications]
    [/side]
    [side]
        side=2
        controller=ai
        canrecruit=yes
        recruit="Spearman, Bowman, Cavalryman, Javelineer, Longbowman"
        team_name="Loyalists"
        user_team_name =_  "Wesnothian Commander"
        {GOLD 50 70 90}
        type="Grand Marshal"
        name="Histen"
        id="Histen"
        unrenamable=yes
        [ai]
            leader_aggression={ON_DIFFICULTY 0.0 0.1 0.2}
            [goal]
                name=target_location
                [criteria]
                    x,y=17,6
                [/criteria]
                value={ON_DIFFICULTY 7 6 5}
            [/goal]
            [goal]
                [criteria]
                    id=Alyssa
                [/criteria]
                value={ON_DIFFICULTY 9 8 7}
            [/goal]
        [/ai]
    [/side]

    [side]
        side=3
        controller=ai
        canrecruit=yes
        recruit="Spearman, Bowman, Cavalryman"
        team_name="Loyalists"
        user_team_name =_  "Wesnothian Support"
        {GOLD 40 60 80}
        type="General"
        name="Farren"
        id="Farren"
        unrenamable=yes
        [ai]
            leader_aggression={ON_DIFFICULTY 0.0 0.1 0.2}
            [goal]
                name=target_location
                [criteria]
                    x,y=17,6
                [/criteria]
                value={ON_DIFFICULTY 7 6 5}
            [/goal]
            [goal]
                [criteria]
                    id=Alyssa
                [/criteria]
                value={ON_DIFFICULTY 9 8 7}
            [/goal]
        [/ai]
    [/side]

    [side]
        side=4
        controller=ai
        canrecruit=yes
        recruit="Spearman, Bowman, Cavalryman"
        team_name="Loyalists"
        user_team_name =_  "Wesnothian Support"
        {GOLD 40 60 80}
        type="General"
        name="Tiran"
        id="Tiran"
        unrenamable=yes
        [ai]
            leader_aggression={ON_DIFFICULTY 0.0 0.1 0.2}
            [goal]
                name=target_location
                [criteria]
                    x,y=17,6
                [/criteria]
                value={ON_DIFFICULTY 7 6 5}
            [/goal]
            [goal]
                [criteria]
                    id=Alyssa
                [/criteria]
                value={ON_DIFFICULTY 9 8 7}
            [/goal]
        [/ai]
    [/side]

    [side]
        side=5
        controller=ai
        canrecruit=yes
        recruit="Swordsman, Halberdier, Iron Mauler, Longbowman"
        team_name="Aragwaith"
        user_team_name =_  "Lady Alyssa of Elensefar"
        {GOLD 150 170 190}
        type="Great Mage"
        name="Lady Alyssa II"
        id="Alyssa"
        gender=female
        unrenamable=yes
        [ai]
            grouping=defensive
            support_villages=yes
            caution={ON_DIFFICULTY 0.9 0.8 0.7}
            aggression={ON_DIFFICULTY 0.1 0.2 0.3}
            [goal]
                name=protect_location
                [criteria]
                    x,y=17,6
                [/criteria]
                protect_radius=5
                value={ON_DIFFICULTY 7 6 5}
            [/goal]
            [goal]
                name=protect_unit
                [criteria]
                    id=Alyssa
                [/criteria]
                protect_radius=5
                value={ON_DIFFICULTY 9 8 7}
            [/goal]
        [/ai]
    [/side]

    [side]
        side=6
        controller=ai
        canrecruit=yes
        recruit="Cavalryman, Horseman, Spearman, Bowman"
        team_name="Aragwaith"
        user_team_name =_  "Elensefarian Defenders"
        {GOLD 140 160 180}
        type="Grand Knight"
        name="Hytan"
        id="Hytan"
        unrenamable=yes
        [ai]
            grouping=defensive
            support_villages=yes
            caution={ON_DIFFICULTY 0.9 0.8 0.7}
            aggression={ON_DIFFICULTY 0.1 0.2 0.3}
        [/ai]
    [/side]

    [side]
        side=7
        controller=ai
        canrecruit=yes
        recruit="Cavalryman, Horseman, Spearman, Bowman"
        team_name="Aragwaith"
        user_team_name =_  "Elensefarian Defenders"
        {GOLD 140 160 180}
        type="Grand Knight"
        name="Ingan"
        id="Ingan"
        unrenamable=yes
        [ai]
            grouping=defensive
            support_villages=yes
            caution={ON_DIFFICULTY 0.9 0.8 0.7}
            aggression={ON_DIFFICULTY 0.1 0.2 0.3}
        [/ai]
    [/side]

    [event]
        name=prestart

        [objectives]
            side=1
            [objective]
                condition=win
                description= _ "Get Rokuhira to the area by the keep (17,6)."
            [/objective]
            [objective]
                condition=lose
                description= _ "Death of the heroes or Lady Alyssa II."
            [/objective]
            {TURNS_RUN_OUT}
        [/objectives]
        [recall]
            id=Sasaki
            x=16
            y=29
        [/recall]
        [recall]
            id=Asven
            x=19
            y=31
        [/recall]
        [recall]
            id=Yswen
            x=15
            y=32
        [/recall]
    [/event]

    [event]
        name=start
        [message]
            speaker = Sasaki
            message = _ "Is this our haven? It is besieged by a mighty force."
        [/message]
        [message]
            speaker = Alyssa
            message = _ "Elensefar is a haven for all. The lords of Wesnoth see rebels slipping away and so attack us. If you wish to join us, you must break the siege."
        [/message]
        [message]
            speaker = Rokuhira
            message = _ "We are mercenaries, but this trampling of independence disgusts us. My help will be free."
        [/message]
        [message]
            speaker = Sasaki
            message = _ "You have to pay me, thou—ouch!"
        [/message]
        [message]
            speaker = Yswen
            message = _ "Our encampment provides little protection. We ought to enter as soon as possible."
        [/message]
        [message]
            speaker = Asven
            message = _ "The battlefield is wide. Cavalry will be very useful here if we need to strike quickly."
        [/message]
        [message]
            speaker = Histen
            message = _ "I am a Grand Marshal of the Wesnothian army! Soon we will finish building these encampments, and we shall construct ballistae. Then the city will be destroyed!"
        [/message]
        [message]
            speaker = Histen
            message = _ "Enemies behind! Quick, to arms! Mage, the spell—now I am invincible!"
        [/message]
        {HIGHLIGHT_IMAGE 17 6 scenery/signpost.png ()}
    [/event]

    [event]
        name = moveto
        [filter]
            x = 17
            y = 6
            id=Rokuhira
        [/filter]
        [message]
            speaker=Rokuhira
            message=_ "We've made it to Elensefar, soldiers! Take a break, but we need to prepare for war."
        [/message]
        [endlevel]
            result=victory
        [/endlevel]
    [/event]

    [event]
        name=last breath
        first_time_only = no
        [filter]
            id=Histen
        [/filter]
        [message]
            speaker = Histen
            message = _ "I have the invincible armor of the plot!"
        [/message]
        {ADVANCE_UNIT (id="Histen") ()}
    [/event]

    [event]
        name=last breath
        [filter]
            id=Alyssa
        [/filter]
        [message]
            speaker=Alyssa
            message = _ "Shall I finally see Elensefar fall?"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Rokuhira
        [/filter]
        [message]
            speaker = Rokuhira
            message = _ "No! I am defeated!"
        [/message]
        [endlevel]
            result = defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Sasaki
        [/filter]
        [message]
            speaker=Sasaki
            message = _ "I have no arrows, the enemies are charging towards me. I... I am about to die."
        [/message]
        [endlevel]
            result = defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Asven
        [/filter]
        [message]
            speaker = Asven
            message = _ "This adventure... over... too soon."
        [/message]
        [endlevel]
            result = defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Yswen
        [/filter]
        [message]
            speaker = Yswen
            message = _ "I... I can taste blood... the pain..."
        [/message]
        [endlevel]
            result = defeat
        [/endlevel]
    [/event]
[/scenario]
